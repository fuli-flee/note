[toc]
***
# 一. Unity跨平台基本原理

## 1. .Net相关知识

### 1.1 .Net是什么
微软的.Net既不是编程语言也不是框架
是类似于互联网时代、次时代、21世纪、信息时代之类的宣传口号
它是一整套技术体系的统称,或者说它是微软提供的技术平台的代号

包含的内容有
- 框架体系:.Net Framework、.Net Core、Mono等等
- 开发语言:C#、VB、F#等等(C#是.Net平台主推的开发语言(1)
- 开发工具:Visual Studio、Visual Studio Code等等

你可以简单理解.Net本质上就是微软为自己的一系列产品取的一个代号

### 1.2 目的
1. 跨语言
只要是面向.NET平台的编程语言(C#、VB、C++、F#等等),用其中一种语言编
写的内容可以无缝地用在另一种语言编写的应用程序中

2. 跨平台
一次编译,不需要任何代码修改,应用程序就可以运行在任王意有.NET框架实现的
操作系统上,即代码不依赖于操作系统,也不依赖硬件环境

### 1.3 如何实现的跨语言
- `CLS (Common Language Specification)` 
公共语言规范
.Net专门参考每种语言并找出了语言间的共性,定义了一组规则。
与其说是规则,不如说它是一组**语言互操作的标准规范**
只要开发者都遵守这个规则来编码,那么代码就能被任意.Net平台支持的语言所
通用,即可以通过不同的编程语言(C#、VB、J#等等)来创建应用程序
</br>

- `CTS (Common Type System)`
公共类型系统
**当你需要设计面向.Net的语言时需要遵循一个体系,这个体系就是CTS
刚才提到的CLS公共语言规范就是是CTS公共类型系统的子级**
一个编程语言,如果**它能够支持CTS,那么我们就称它为面向.NET平台的语言**
</br>

- `CLI (Common Language Infrastructure)`
公共语言基础结构
**是微软将CTS等内容提交给国际组织计算机制造联合会ECMA的的一个工业标准**
</br>

- `总结`
微软为了实现跨语言,制定了一些规范
**只要一门语言支持CTS(公共类型系统)的规则
那么我们就能够使用它在.Net平台下开发应用程序**
CLS(公共语言规范)是CTS的一个子级,是一组**语言互操作的的标准规范**
我们经常可以看到的**CLI**公共语言基础结构,**它包含CTS**公共类型系统
它是**微软将CTS等内容提交给国际组织计算机制造联合会ECMA的一个工业标准**

### 1.4 如何实现的跨平台
.Net的跨语言是让各种语言支持.Net的规范CLI(也就是CTS等规范)
**早期的.Net系列产品主要是为了给Windows操作系统服务的**
并没有跨平台的特性,即使跨语言了
也只是可以使用多语言开发Windows上的应用程序

### 1.5 .Net Framework
.Net Framework在2002年推出1.0版本
.NET Framework是一个可以快速开发、部署网站服务及应用程序的开发框架
是Windows中的一个组件,部分开源,主要用于开发Windows下应用程序

包括
- 公共语言运行时(Common Language Runtime,CLR)
- 虚拟执行系统
- .NET Framework 类库等

#### 1.5.1 体系结构
<center>

![alt text](/CSharp/图片/补充/CSharp补充10-20_17-21-27.jpg)
![alt text](/CSharp/图片/补充/CSharp补充10-20_17-17-29.jpg)

</center>

**制作应用程序
编程语言+调用各种类库进行开发生成程序集**

1. 只要支持CLS公共语言规范的语言都可以用于开发Windows下的各种应用程序和网站程序
2. BCL(基础类库)和FCL(框架类库)是这个框架体系中为我们实现好的各种API
3. 程序集的表现就是后缀为.dll或者.exe格式的文件, 其中包含的最关键信息:
   - PE头、CLR头(就是一些程序的格式信息,比如入口方法,版本号等等)
   - CIL代码(通用中间代码)是介于源代码和机器码之间的代码之后会通过CLR产生机器码

CIL代码你可以理解为由于可能使用不同的代码进行开发,所以会会将这些代码翻译为统一规范的中间代码 


**让应用程序在操作系统上运行**
**起作用的就是 CLR (Common Language Runtime)公共语言运行时**
它是 .Net Framework的基础,所有的.Net技术都是建立在此之上的
它是一个在执行时管理代码的代码,
提供内存管理、线程管理等等核心服务,
就好像一个小型的操作系统一样
所以形象的把它称为".Net虚拟机"。
如果想要应用程序在目标操作系统上能够运行
就必须依靠 .Net 提供的CLR环境来支持
那就必须在操作系统上安装 .Net Framework
它会将程序集中的IL(中间代码) 翻译为机器码最终在操作系统上运行

<center>

![alt text](/CSharp/图片/补充/CSharp补充10-20_17-35-34.jpg)

</center>

### 1.6 .Net Core
.Net Core 是2016年推出的 .Net Framework的新一代版本, 它就像是 .Net Framework的兄弟
**是 .Net Framework的翻版实现,它是一个开源项目**
它是基于 .Net Framework来进行设计的主要目的就是跨平台
是 .Net 技术框架组成在Windows、MacOS、类Linux系统下的具体实现
**它的原理就是为不同的操作系统实现对应的
CLR公共语言运行时(.Net虚拟机)
这样就可以在不同的平台上
将IL(中间代码)翻译成机器码最终在操作系统上运行了**

### 1.7 Mono
从上面的知识我们可以认识到 .Net FrameWork是不跨平台的, 而 .Net Core 是支持跨平台的, 那从2002年FrameWork的诞生到2016年Core的诞生中间有14年的空窗期, 那这就催生了Mono这个跨平台的项目

Mono是一个由Xamarin公司(已被微软收购)所赞助的开源项目
**它基于.Net的CLI(Common Language Infrastructure)公共语言基础结构**
提供了微软 .Net FrameWork的另一种实现
**它相对 .Net FrameWork最大的区别就是具备跨平台的能力**
它不仅可以运行在Windows、MacOS、Linux等操作系统
甚至还可以运行在PS3、XBOX、Wii等主机平台上
Mono的1.0版本出现在2004年
也就是说在 .Net Core出现之前,Mono是.Net平台实现跨平台的不二之选

#### 1.7.1 Mono如何实现的跨平台
Mono利用 .Net平台制定的CLI公共语言基础结构规则
利用它我们可以**把很多种语言编译成通用规范的CIL公共中间语言**
**再利用CLR公共语言运行时**,将这些**CIL公共中间语言转换元为
操作系统的原生代码 (主要做的就是在各种操作系统上实现了对应的CLR内容) **
这样用各种不同语言编写的逻辑就能够在指定操作系统上运运行了
它的这一套规则是在 .Net Framework规则上进行的修改和添加음